"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[1620],{578(e,s,i){i.r(s),i.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"walrus-sites/routing","title":"Specifying Headers, Routing, and Metadata","description":"Guide to configuring custom headers, client-side routing, and metadata for Walrus Sites using ws-resources.json.","source":"@site/../content/walrus-sites/routing.mdx","sourceDirName":"walrus-sites","slug":"/walrus-sites/routing","permalink":"/docs/walrus-sites/routing","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/walrus-sites/routing.mdx","tags":[],"version":"current","frontMatter":{"title":"Specifying Headers, Routing, and Metadata","description":"Guide to configuring custom headers, client-side routing, and metadata for Walrus Sites using ws-resources.json.","keywords":["walrus sites","headers","routing","metadata","ws-resources","configuration","client-side routing","spa"]},"sidebar":"sitesSidebar","previous":{"title":"Configuring the Site Builder","permalink":"/docs/walrus-sites/builder-config"},"next":{"title":"Linking from and to Walrus Sites","permalink":"/docs/walrus-sites/linking"}}');var t=i(5656),r=i(6145);const o={title:"Specifying Headers, Routing, and Metadata",description:"Guide to configuring custom headers, client-side routing, and metadata for Walrus Sites using ws-resources.json.",keywords:["walrus sites","headers","routing","metadata","ws-resources","configuration","client-side routing","spa"]},d=void 0,a={},c=[{value:"The <code>ws-resources.json</code> file",id:"the-ws-resourcesjson-file",level:2},{value:"Specifying HTTP response headers (<code>headers</code>)",id:"specifying-http-response-headers-headers",level:2},{value:"Default headers",id:"default-headers",level:3},{value:"Specifying client-side routing (<code>routes</code>)",id:"specifying-client-side-routing-routes",level:2},{value:"Displaying the site object on wallets and explorers (`metadata)",id:"displaying-the-site-object-on-wallets-and-explorers-metadata",level:2},{value:"Site name (<code>site_name</code>)",id:"site-name-site_name",level:2},{value:"Site object ID (<code>object_id</code>)",id:"site-object-id-object_id",level:2},{value:"Ignoring files from being uploaded",id:"ignoring-files-from-being-uploaded",level:2}];function l(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components},{Term:i}=s;return i||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Term",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p,{children:["In its base configuration, Walrus Sites serves static assets through a portal. However, many modern web applications require more advanced features, such as custom headers and ",(0,t.jsx)(i,{lookup:"Client",children:"client"}),"-side routing."]}),"\n",(0,t.jsxs)(s.p,{children:["Therefore, the ",(0,t.jsx)(s.code,{children:"site-builder"})," can read a ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," configuration file, in which you can directly specify resource headers and routing rules."]}),"\n",(0,t.jsxs)(s.h2,{id:"the-ws-resourcesjson-file",children:["The ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file"]}),"\n",(0,t.jsxs)(s.p,{children:["This file is optionally placed in the root of the site directory, and it is not uploaded with the site's resources. If you don't want to use this default location, you can specify the path to the configuration file with the ",(0,t.jsx)(s.code,{children:"--ws-resources"})," flag when running the ",(0,t.jsx)(s.code,{children:"deploy"}),", ",(0,t.jsx)(s.code,{children:"publish"})," or ",(0,t.jsx)(s.code,{children:"update"})," commands."]}),"\n",(0,t.jsx)(s.p,{children:"The file is JSON-formatted, and looks like the following:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'{\n  "headers": {\n    "/index.html": {\n    "Content-Type": "text/html; charset=utf-8",\n    "Cache-Control": "max-age=3500"\n    }\n  },\n  "routes": {\n    "/*": "/index.html",\n    "/accounts/*": "/accounts.html",\n    "/path/assets/*": "/assets/asset_router.html"\n  },\n  "metadata": {\n    "link": "https://subdomain.wal.app",\n    "image_url": "https://www.walrus.xyz/walrus-site",\n    "description": "This is a walrus site.",\n    "project_url": "https://github.com/MystenLabs/walrus-sites/",\n    "creator": "MystenLabs"\n  },\n  "site_name": "My Walrus Site",\n  "object_id": "0xe674c144119a37a0ed9cef26a962c3fdfbdbfd86a3b3db562ee81d5542a4eccf",\n  "ignore": ["/private/*", "/secret.txt", "/images/tmp/*"]\n}\n'})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file expects the field names to be in ",(0,t.jsx)(s.code,{children:"snake_case"}),"."]}),"\n",(0,t.jsxs)(s.h2,{id:"specifying-http-response-headers-headers",children:["Specifying HTTP response headers (",(0,t.jsx)(s.code,{children:"headers"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"headers"})," section allows you to specify custom HTTP response headers for specific resources. The keys in the ",(0,t.jsx)(s.code,{children:"headers"})," object are the paths of the resources, and the values are lists of key-value pairs corresponding to the headers that the portal attaches to the response."]}),"\n",(0,t.jsxs)(s.p,{children:["In the example, the file ",(0,t.jsx)(s.code,{children:"index.html"})," is served with the ",(0,t.jsx)(s.code,{children:"Content-Type"})," header set to ",(0,t.jsx)(s.code,{children:"text/html; charset=utf-8"})," and the ",(0,t.jsx)(s.code,{children:"Cache-Control"})," header set to ",(0,t.jsx)(s.code,{children:"max-age=3500"}),". he resource path is always represented as starting from the root ",(0,t.jsx)(s.code,{children:"/"}),"."]}),"\n",(0,t.jsx)(s.p,{children:"This mechanism allows you to control various aspects of the resource delivery, such as caching, encoding, and content types."}),"\n",(0,t.jsx)(s.h3,{id:"default-headers",children:"Default headers"}),"\n",(0,t.jsxs)(s.p,{children:["By default, no headers need to be specified, and the ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file can be omitted. The ",(0,t.jsx)(s.code,{children:"site-builder"})," automatically tries to infer the ",(0,t.jsx)(s.code,{children:"Content-Type"})," header based on the file extension, and set the ",(0,t.jsx)(s.code,{children:"Content-Encoding"})," to ",(0,t.jsx)(s.code,{children:"identity"})," (no transformation)."]}),"\n",(0,t.jsxs)(s.p,{children:["In case the content type cannot be inferred, the ",(0,t.jsx)(s.code,{children:"Content-Type"})," is set to ",(0,t.jsx)(s.code,{children:"application/octet-stream"}),". These defaults are overridden by any headers specified in the ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file."]}),"\n",(0,t.jsxs)(s.h2,{id:"specifying-client-side-routing-routes",children:["Specifying ","client","-side routing (",(0,t.jsx)(s.code,{children:"routes"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"routes"})," section allows you to specify ","client","-side routing rules for your site. This is useful when you want to use a single-page application (SPA) framework, such as React or Angular. The configuration in the ",(0,t.jsx)(s.code,{children:"routes"})," object is a mapping from route keys to resource paths."]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsxs)(s.strong,{children:[(0,t.jsx)(s.code,{children:"routes"})," keys"]})," are path patterns in the form ",(0,t.jsx)(s.code,{children:"/path/to/some/*"}),", where the ",(0,t.jsx)(s.code,{children:"*"})," character represents a wildcard."]}),"\n",(0,t.jsx)(s.admonition,{type:"info",children:(0,t.jsxs)(s.p,{children:["Currently, the wildcard can only be specified at the end of the path. Therefore, ",(0,t.jsx)(s.code,{children:"/path/*"})," is a valid path, while ",(0,t.jsx)(s.code,{children:"/path/*/to"})," and ",(0,t.jsx)(s.code,{children:"*/path/to/*"})," are not."]})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"routes"})," values are the resource paths that should be served when the route key is matched. These paths in the values ",(0,t.jsx)(s.strong,{children:"must"})," be valid resource paths, meaning that they must be present among the site's resources. The Walrus sites contract ",(0,t.jsx)(s.strong,{children:"aborts"})," if you try to create a route that points to a non-existing resource."]}),"\n",(0,t.jsx)(s.p,{children:"The simple routing algorithm is as follows:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Whenever a resource path is not found among the sites resources, the portal tries to match the path to the ",(0,t.jsx)(s.code,{children:"routes"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"All matching routes are then lexicographically ordered, and the longest match is chosen."}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsx)(s.p,{children:"The resource corresponding to this longest match is then served."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"In the previous example:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"routes": {\n  "/*": "/index.html",\n  "/path/*": "/accounts.html",\n  "/path/assets/*": "/assets/asset_router.html"\n}\n'})}),"\n",(0,t.jsx)(s.p,{children:"The following matchings occur:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Browsing ",(0,t.jsx)(s.code,{children:"/any/other/test.html"})," serves ",(0,t.jsx)(s.code,{children:"/index.html"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Browsing ",(0,t.jsx)(s.code,{children:"/path/test.html"})," serves ",(0,t.jsx)(s.code,{children:"/accounts.html"}),", as it is a more specific match than the previous one."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:["Similarly, browsing ",(0,t.jsx)(s.code,{children:"/path/assets/test.html"})," serves ",(0,t.jsx)(s.code,{children:"/assets/asset_router.html"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"/index.html"}),", ",(0,t.jsx)(s.code,{children:"/accounts.html"}),", and ",(0,t.jsx)(s.code,{children:"/assets/asset_router.html"})," are all existing resources on the Walrus Sites object on Sui."]}),"\n",(0,t.jsx)(s.h2,{id:"displaying-the-site-object-on-wallets-and-explorers-metadata",children:"Displaying the site object on wallets and explorers (`metadata)"}),"\n",(0,t.jsxs)(s.p,{children:["It's possible to make your Site object prettier by displaying information about it on Sui explorers and wallets by using the ",(0,t.jsx)(s.code,{children:"metadata"})," field. This is useful for adding human-readable information about the site. For example, you can add a link to your site's homepage, an image of your site's logo, and so on."]}),"\n",(0,t.jsxs)(s.p,{children:["In the previous example, the fields correspond to the basic set of properties suggested by the ",(0,t.jsx)(s.a,{href:"https://docs.sui.io/standards/display#display-properties",children:"Sui Display object standard"}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"metadata": {\n    "link": "https://subdomain.wal.app",\n    "image_url": "https://www.walrus.xyz/walrus-site",\n    "description": "This is a walrus site.",\n    "project_url": "https://github.com/MystenLabs/walrus-sites/",\n    "creator": "MystenLabs"\n  }\n'})}),"\n",(0,t.jsxs)(s.p,{children:["All metadata fields are optional and can be omitted if not needed. There are some default values specified in the ",(0,t.jsx)(s.code,{children:"site-builder"})," CLI, which can be overridden by your configuration."]}),"\n",(0,t.jsx)(s.p,{children:"It is recommended to use the above fields like this:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"link"}),": Add a link to your site's homepage."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"image_url"}),": Include a URL to your site's logo which is displayed on your wallet. For example you can place a link to your sites favicon."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"description"}),": Add a brief description of your site."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"project_url"}),": If your site is open-source, add a link to your site's GitHub repository."]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.code,{children:"creator"}),": Add the name of your company, group, or individual creator of your site."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.h2,{id:"site-name-site_name",children:["Site name (",(0,t.jsx)(s.code,{children:"site_name"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:["You can set a name for your Walrus Site through the optional ",(0,t.jsx)(s.code,{children:"site_name"})," field in your ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file. In case you have also provided a site name through the ",(0,t.jsx)(s.code,{children:"--site-name"})," CLI flag, the CLI flag takes priority over the ",(0,t.jsx)(s.code,{children:"site_name"})," field in the ",(0,t.jsx)(s.code,{children:"ws-resources.json"}),", which is overwritten. If a site name is not provided at all, then a default name is used."]}),"\n",(0,t.jsxs)(s.h2,{id:"site-object-id-object_id",children:["Site object ID (",(0,t.jsx)(s.code,{children:"object_id"}),")"]}),"\n",(0,t.jsxs)(s.p,{children:["The optional ",(0,t.jsx)(s.code,{children:"object_id"})," field in your ",(0,t.jsx)(s.code,{children:"ws-resources.json"})," file stores the Sui object ID of your deployed Walrus Site."]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"site-builder deploy"})," command primarily uses this field to identify an existing site for updates. If a valid ",(0,t.jsx)(s.code,{children:"object_id"})," is present, ",(0,t.jsx)(s.code,{children:"deploy"})," targets that site for modifications. If this field is missing and no ",(0,t.jsx)(s.code,{children:"--object-id"})," CLI flag is used, ",(0,t.jsx)(s.code,{children:"deploy"})," publishes a new site. If successful, then the command automatically populates this ",(0,t.jsx)(s.code,{children:"object_id"})," field in your ",(0,t.jsx)(s.code,{children:"ws-resources.json"}),"."]}),"\n",(0,t.jsx)(s.h2,{id:"ignoring-files-from-being-uploaded",children:"Ignoring files from being uploaded"}),"\n",(0,t.jsxs)(s.p,{children:["You can use the optional ",(0,t.jsx)(s.code,{children:"ignore"})," field to exclude certain files or folders from being published. This is useful when you want to keep development files, secrets, or temporary assets out of the final build."]}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"ignore"})," field is a list of resource paths to skip. Each pattern must start with a ",(0,t.jsx)(s.code,{children:"/"}),", and might end with a ",(0,t.jsx)(s.code,{children:"*"})," to indicate a wildcard match."]}),"\n",(0,t.jsx)(s.p,{children:"For example:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-json",children:'"ignore": [\n  "/private/*",\n  "/secret.txt",\n  "/images/tmp/*"\n]\n'})}),"\n",(0,t.jsxs)(s.p,{children:["This configuration skips all files inside the ",(0,t.jsx)(s.code,{children:"/private/"})," and ",(0,t.jsx)(s.code,{children:"/images/tmp/"})," directories, as well as a specific file ",(0,t.jsx)(s.code,{children:"/secret.txt"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["Wildcards are only supported in the ",(0,t.jsx)(s.strong,{children:"last position"})," of the path, for example, ",(0,t.jsx)(s.code,{children:"/foo/*"})," is valid, but ",(0,t.jsx)(s.code,{children:"/foo/*/bar"})," is not."]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},6145(e,s,i){i.d(s,{R:()=>o,x:()=>d});var n=i(7140);const t={},r=n.createContext(t);function o(e){const s=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(r.Provider,{value:s},e.children)}}}]);